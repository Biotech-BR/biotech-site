@layer components {
  /* grid do background (antes era inline) */
  .process-bg-grid {
    background-image:
      linear-gradient(to right, rgba(255,255,255,0.16) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(255,255,255,0.16) 1px, transparent 1px);
    background-size: 72px 72px;
  }

  /* ===== palco full width (sem card) ===== */
  .process-stage {
    @apply relative overflow-hidden;
    height: 520px;
  }

  /* Ajuda o navegador a isolar pintura/layout (bom p/ perf) */
  .process-stage {
    contain: layout paint;
  }
  @supports (content-visibility: auto) {
    .process-stage {
      content-visibility: auto;
      contain-intrinsic-size: 520px;
    }
  }

  /* rails (colunas) */
  .process-rails {
    @apply absolute inset-0;
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    opacity: 0.45;
    z-index: 0;
  }

  .process-rail { @apply relative; }

  .process-rail::before {
    content: "";
    position: absolute;
    inset: 0;
    width: 1px;
    margin: 0 auto;
    background: linear-gradient(to bottom, transparent, rgba(255,255,255,0.18), transparent);
  }

  /* ===== linha viva (desktop) ===== */
  .process-line {
    @apply absolute inset-x-0;
    top: 84%;
    height: 2px;
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(45,211,227,0.28) 18%,
      rgba(255,255,255,0.14) 50%,
      rgba(119,215,108,0.22) 82%,
      transparent 100%
    );
    /* drop-shadow mais leve */
    filter:
      drop-shadow(0 0 12px rgba(45,211,227,0.10))
      drop-shadow(0 0 22px rgba(119,215,108,0.07));
    opacity: 0.92;
    z-index: 0;
  }

  .process-scan {
    @apply absolute inset-x-0;
    top: calc(84% - 1px);
    height: 4px;
    background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.55) 50%, transparent 100%);
    filter:
      drop-shadow(0 0 10px rgba(45,211,227,0.18))
      drop-shadow(0 0 18px rgba(119,215,108,0.10));
    opacity: 0.20;
    animation: process-scan 6.4s linear infinite;
    z-index: 0;
  }

  @keyframes process-scan {
    0%   { transform: translateX(-55%); opacity: .08; }
    18%  { opacity: .20; }
    55%  { opacity: .16; }
    100% { transform: translateX(55%); opacity: .08; }
  }

  /* ===== partículas (desktop) ===== */
  .process-dots { @apply absolute inset-0; z-index: 0; }

  .pd {
    @apply absolute rounded-full;
    width: 6px;
    height: 6px;
    opacity: 0;
    filter: drop-shadow(0 0 8px rgba(45,211,227,0.14));
    animation: process-dot-fall 7.2s ease-in-out infinite;
  }

  .pd-a { left: 14%; top: 18%; background: rgba(45,211,227,0.50); animation-delay: .0s; }
  .pd-b { left: 28%; top: 10%; background: rgba(119,215,108,0.40); animation-delay: 1.4s; width: 5px; height: 5px; }
  .pd-c { left: 52%; top: 16%; background: rgba(45,211,227,0.40); animation-delay: 2.7s; width: 4px; height: 4px; }
  .pd-d { left: 74%; top: 12%; background: rgba(119,215,108,0.38); animation-delay: 3.6s; }
  .pd-e { left: 88%; top: 22%; background: rgba(45,211,227,0.40); animation-delay: 4.8s; width: 4px; height: 4px; }

  @keyframes process-dot-fall {
    0%   { transform: translate3d(0,-10px,0); opacity: 0; }
    14%  { opacity: .38; }
    60%  { opacity: .20; }
    100% { transform: translate3d(0, 140px, 0); opacity: 0; }
  }

  /* ===== pills ===== */
  .process-pill {
    @apply rounded-2xl px-7 py-4 ring-1 ring-white/10 text-white font-semibold;
    position: relative;
    overflow: hidden;

    background: linear-gradient(90deg, rgba(45,211,227,0.16), rgba(119,215,108,0.12));

    box-shadow:
      0 20px 52px rgba(0,0,0,0.56),
      0 0 0 1px rgba(255,255,255,0.03) inset;

    /* DESKTOP: mantém premium */
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);

    z-index: 2;
  }

  .process-pill::before {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(closest-side at 18% 22%, rgba(255,255,255,0.10), rgba(0,0,0,0) 62%);
    opacity: 0.65;
    pointer-events: none;
  }

  .process-pill::after {
    content: "";
    position: absolute;
    left: 10px;
    top: 14px;
    bottom: 14px;
    width: 3px;
    border-radius: 999px;
    background: linear-gradient(to bottom, rgba(45,211,227,0.78), rgba(119,215,108,0.62));
    opacity: 0.45;
    pointer-events: none;
  }

  .process-pill__inner { @apply relative flex items-center gap-3; }

  .process-pill__num {
    @apply text-xs font-semibold text-white/60;
    letter-spacing: .12em;
  }

  .process-pill__text {
    @apply relative;
    font-size: 15px;
    line-height: 1.2;
    letter-spacing: 0.2px;
  }

  /* ===== DESKTOP: grid staircase ===== */
  .process-grid {
    @apply relative z-[2] grid grid-cols-12 grid-rows-6 items-center;
    height: 100%;
    padding-top: 54px;
    padding-bottom: 78px;
    column-gap: 18px;
    row-gap: 18px;
  }

  .process-pill--grid {
    opacity: 0;
    transform: translate3d(0, calc(var(--fall, 14px) * -1), 0);
    transition:
      opacity 900ms cubic-bezier(.2,.8,.2,1),
      transform 900ms cubic-bezier(.2,.8,.2,1);
  }

  .process-pill--grid.is-visible {
    opacity: 1;
    transform: translate3d(0, 0, 0);
    animation: process-drift 7.6s ease-in-out infinite;
    animation-delay: calc(var(--d) * 160ms + 420ms);
    will-change: transform;
  }

  @keyframes process-drift {
    0%, 100% { transform: translate3d(0, 0, 0); }
    50%      { transform: translate3d(0, 8px, 0); }
  }

  /* ===== MOBILE list ===== */
  .process-mobile { @apply relative pl-6; }

  .process-mobile::before {
    content: "";
    position: absolute;
    top: 2px;
    bottom: 2px;
    left: 10px;
    width: 2px;
    background: linear-gradient(to bottom, rgba(45,211,227,0.22), rgba(119,215,108,0.20));
    opacity: 0.85;
  }

  .process-mobile__row { @apply relative mb-4; }

  .process-mobile__dot {
    @apply absolute rounded-full;
    left: 6px;
    top: 18px;
    width: 10px;
    height: 10px;
    background: rgba(45,211,227,0.62);
    box-shadow: 0 0 0 3px rgba(45,211,227,0.10);
  }

  .process-pill--solid {
    @apply w-full;
    opacity: 0;
    transform: translate3d(0, -8px, 0);
    transition:
      opacity 520ms cubic-bezier(.2,.8,.2,1),
      transform 520ms cubic-bezier(.2,.8,.2,1);
  }

  .process-pill--solid.is-visible {
    opacity: 1;
    transform: translate3d(0,0,0);
    /* no mobile vamos desligar drift no media query abaixo */
  }

  /* ======================================
     MOBILE LITE (mantém bonito, bem mais leve)
     ====================================== */
  @media (max-width: 1023px) {
    /* grid mais leve */
    .process-bg-grid {
      opacity: 0.03;
      background-size: 96px 96px; /* menos linhas => menos custo */
    }

    /* desliga efeitos desktop pesados */
    .process-scan,
    .process-dots,
    .process-rails {
      display: none !important;
    }

    /* Mantém um toque “vivo” no mobile: a linha do timeline já cumpre isso */

    /* remove backdrop blur (mais caro no mobile) */
    .process-pill {
      backdrop-filter: none !important;
      -webkit-backdrop-filter: none !important;

      /* ainda premium */
      background: linear-gradient(90deg, rgba(45,211,227,0.12), rgba(119,215,108,0.10));
      box-shadow:
        0 14px 34px rgba(0,0,0,0.52),
        0 0 0 1px rgba(255,255,255,0.03) inset;
    }

    /* sem drift infinito no mobile */
    .process-pill--solid.is-visible,
    .process-pill--grid.is-visible {
      animation: none !important;
      will-change: auto !important;
    }
  }

  /* ===== reduce motion ===== */
  @media (prefers-reduced-motion: reduce) {
    .process-scan, .pd { animation: none !important; opacity: .18 !important; }
    .process-pill--grid, .process-pill--solid {
      transition: none !important;
      animation: none !important;
      transform: none !important;
      opacity: 1 !important;
    }
  }
}
